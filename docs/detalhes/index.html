<!DOCTYPE html>
<html lang="pt-br">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Parfum d'Or</title>
	<link rel="stylesheet" href="styles.css">
</head>

<body>

	<header>
		<h1>Parfum d'Or</h1>
		<a href="../index.html" class="back-link" aria-label="Voltar para a lista de perfumes">← Voltar</a>
	</header>

	<main id="product-details" class="container">
		<p>Carregando detalhes do produto...</p>
	</main>

	<script>
		// Helper para obter parâmetro da URL
		function getQueryParam(param) {
			const params = new URLSearchParams(window.location.search);
			return params.get(param);
		}

		const productSlug = getQueryParam('product');

		fetch('../data.json')
			.then(res => {
				if (!res.ok) throw new Error('Erro ao carregar os dados.');
				return res.json();
			})
			.then(data => {
				const perfumes = data.perfumes || [];
				const product = perfumes.find(p => {
					
					const slug = p.id || p.name.toLowerCase().replace(/\s+/g, '-');
					return slug === productSlug;
				});

				const container = document.getElementById('product-details');

				if (!product) {
					container.innerHTML = '<p>Produto não encontrado.</p>';
					return;
				}

				// Usa detalhes.description se existir e não vazio, senão description
				const descricao = product.detalhes && product.detalhes.description.trim() !== ''
					? product.detalhes.description
					: product.description;

				container.innerHTML = `
                    <h2 class="product-name">${product.name}</h2>
                    <div class="product-info">
                        <p class="product-description">${descricao || 'Descrição não disponível.'}</p>
                    </div>

                    <!-- Como Usar -->
                    <section id="usos">
                        <h3>Como Usar</h3>
                        <ul>
                            ${product.usos.map(uso => `<li>${uso}</li>`).join('')}
                        </ul>
                    </section>

                    <!-- Ocasiões Perfeitas -->
                    <section id="ocasioes">
                        <h3>Ocasiões Perfeitas</h3>
                        <ul>
                            ${product.ocasioes.map(ocasião => `<li>${ocasião}</li>`).join('')}
                        </ul>
                    </section>

                    <!-- Construção da Fragrância -->
                    <section id="construcao">
                        <h3>Construção da Fragrância</h3>
                        <ul>
                            <li><strong>Notas de Topo:</strong> ${product.construcao.topo}</li>
                            <li><strong>Notas de Coração:</strong> ${product.construcao.coracao}</li>
                            <li><strong>Notas de Fundo:</strong> ${product.construcao.fundo}</li>
                        </ul>
                    </section>

					<!-- Construção da Fragrância -->
                   <section id="ocasioes">
                        <h3>Tempo de Duração</h3>
                        <ul>
                            ${product.beneficio.map(ocasião => `<li>${ocasião}</li>`).join('')}
                        </ul>
                    </section>
                `;
			})
			.catch(err => {
				const container = document.getElementById('product-details');
				console.log(err.message)
				container.innerHTML = `<p class="error">Informação em breve...</p>`;
			});
	</script>

</body>

</html>